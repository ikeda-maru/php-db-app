# 商品管理アプリ

PHP−DB学習後の成果アプリ。
PHPを使用して、商品管理アプリを作成する。

CRUD(クラッド)
- Create
- Read
- Update
- Delete

ファイルの構成
- トップページ     - index.php
- 商品一覧ページ   - read.php
- 商品登録ページ   - create.php
- 商品編集ページ   - update.php
- 商品編集ページ   - update.php
- データの削除機能 - delete.php

## 商品一覧ページ
read.php

### データベースに接続し、商品一覧を表示
1. try-catch文とPDOクラスを使ってデータベースに接続する
2. query()メソッドを使ってSELECT文を実行し、PRODUCTSテーブルからすべてのカラムのデータを取得する
3. FETCHALL()メソッドを使ってSELECT文の実行結果を配列で取得する
4. FOREACH文を使って配列の中身を順番に出力する

### 並び替え機能の作成
1. `a`タグ(並び替えボタン)のhref属性に同じ`read.php`を指定し、末尾に`order`パラメータを付ける(値は`asc`または`desc`)
2. `if (isset($_GET['order'])) {~}`を記述し、`order`パラメータの値が存在すれば(並び替えボタンを押したとき)、その値を変数`$order`に代入する
3. `order`パラメータの値が存在しない場合は、変数`$order`に`NULL`を代入する
4. if文を使い、以下のように条件分岐させてORDER BY句を変更する
  1. 変数`$order`の値が`desc`のとき : 更新日時順(降順)で並び替える
  2. 変数`$order`の値がそれ以外のとき : 更新日時順(昇順)で並び替える

### 検索機能の作成
1. `input`タグの`name`属性に`keyword`を指定し、`keyword`パラメータとその値(入力内容)をフォームから送信できるようにする
2. `if (isset($_GET['keyword'])) {~}`を記述し`keyword`パラメータの値が存在すれば(「検索」ボタンを押したとき)その値を変数$keywordに代入する
3. `prepare()`メソッドを使い、LIKE句の値をプレースホルダ(`:keyword`)に置き換えたSELECT文をあらかじめ用意する
4. 変数`$keyword`の値を`%`で囲み(部分一致)、変数`$partial_match`に代入する(partial match=部分一致)
5. `bindValue()`メソッドを使い、変数`$partial_match`をプレースホルダ(`:keyword`)にバインドする(割り当てる)
6. SQL文を実行する

### 補足
- `form`要素内に`input`要素が1つしかない場合、送信ボタン(`type="submit"`)を作成しなくてもエンターキーを押せば入力内容を送信できる
- `order`パラメータと`keyword`パラメータの療法を同時に渡すことで、並び替え機能と検索機能を同時に使えるようになる
- `form`要素では`input type="hidden"`を使うことで、フォームの入力内容以外の隠しデータ(今回の場合は`order`パラメータとその値)も含めて送信できる
- 隠しデータとはいってもデベロッパーツールなどでソースコードを見ると丸見えなので、他人に知られてはいけないデータは絶対に`input type="hidden"`で送信してはならない